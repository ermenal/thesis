syntax = "proto3";

package security;

option java_package = "com.silabs.ss.platform.internal.security.core.trust.proto";
option java_outer_classname = "TrustFileProto";

// This proto file describes the structure of trusted signables -- that is, some signable,
// normally an sdk, that is considered trusted and thus a signed verification need not be
// performed. This can be for speed ups with known signed sdks, older sdks that have no
// signing status but were installed correctly, or user trusted sdks.

// Compile this with, assuming you are running protoc from one below the studio super
// repo (make sure it comes from the same version that is currently referenced by this project!)

// For studio_dev repo
// ./protoc.exe -I=studio_dev/repos/platform/plugins/com.silabs.ss.platform.security.core/ --java_out=studio_dev/repos/platform/plugins/com.silabs.ss.platform.security.core/src studio_dev/repos/platform/plugins/com.silabs.ss.platform.security.core/resources/protobuf/trusted_storage.proto

// ------------------------- IMPORTANT -----------------------
// If recompiling, make sure you re-add @SuppressWarnings({"unused", "unchecked"})
// to the TrustFileProto.
// 
// TrustFile has a version static field. Make sure you bump that whenever
// you modify and recompile this proto file.
// -----------------------------------------------------------
// Finally, the relative path to this from studio_dev repo will be
// studio_dev/repos/platform/plugins/com.silabs.ss.platform.security.core/resources/protobuf/trusted_storage.proto
// Added here separately so it is easier to refer to via a wide array of command
// line options if other operations need to be done on the file.

message Trusted {
    // root object containing all trust information. Becomes a TrustFile after parsing.
    repeated TrustBlock trust_blocks = 1;
}

message TrustBlock {
    string path = 1;
    string id = 2;
    string version = 3;
    // id and version are ignored if this is set
    bool trust_all = 4;
}
